<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>租金區間試算表</title>

<style>
body{
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans TC",Arial;
  margin:20px;
}
label{display:block;margin-top:10px}
input,select,button{padding:6px 10px;font-size:14px;margin-top:4px}
button{cursor:pointer;margin-top:14px}
fieldset{border:1px solid #ccc;border-radius:10px;padding:12px;margin-top:12px}
legend{font-size:13px;color:#555}
.result{margin-top:20px;font-size:42px;font-weight:bold}
.ok{color:green}
.warn{color:red}
.detail{margin-top:10px;font-size:16px;line-height:1.8}
.bonus-box{
  border:2px solid #f39c12;
  background:#fff7e0;
  padding:12px;
  margin-top:12px;
  border-radius:8px;
}
.note{margin-top:18px;color:red;font-weight:bold}

/* tooltip */
.tooltip{position:relative;display:inline-block;color:#0077cc;font-weight:bold;cursor:pointer}
.tooltip span{
  visibility:hidden;
  opacity:0;
  width:320px;
  background:#333;
  color:#fff;
  padding:10px;
  border-radius:8px;
  position:absolute;
  top:25px;
  left:0;
  z-index:10;
  font-size:13px;
  line-height:1.6;
  transition:.25s;
}
.tooltip.show span{visibility:visible;opacity:1}
</style>
</head>

<body>
<h1>租金區間試算表</h1>

<form id="form">

<label>行政區
<select id="district" required>
<option value="">— 請選擇 —</option>
<option>西屯區</option>
<option>北屯區</option>
<option>南屯區</option>
<option>北區</option>
<option>西區</option>
<option>中區</option>
<option>東區</option>
<option>烏日區</option>
<option>南區</option>
<option>大里區</option>
<option>太平區</option>
<option>潭子區</option>
<option>豐原區</option>
<option>后里區</option>
<option>沙鹿區</option>
<option>龍井區</option>
<option>大肚區</option>
<option>大雅區</option>
<option>神岡區</option>
<option>梧棲區</option>
<option>清水區</option>
<option>大甲區</option>
<option>外埔區</option>
<option>霧峰區</option>
<option>石岡區</option>
<option>東勢區</option>
<option>新社區</option>
<option>其它</option>
</select>
</label>

<label>屋齡（年）
<input id="age" type="number" min="0" required>
</label>

<label>坪數（可小數）
<input id="ping" type="number" step="0.01" min="0" required>
</label>

<label>現在租金
<input id="rent" type="number" min="0" required>
</label>

<fieldset>
<legend>額外加分（僅於未通過時判斷）</legend>

<label>
室內裝修
<select id="deco">
<option value="0">未裝修（0%）</option>
<option value="3">簡易裝修（3%）</option>
<option value="5">中等裝修（5%）</option>
</select>
</label>

<label>
區位
<select id="area">
<option value="0">中下區位（0%）</option>
<option value="3">中上區位（3%）</option>
<option value="5">優質區位（5%）</option>
</select>
</label>

<label>
設備加分金額
<input id="equip" type="number" min="0" value="0">
</label>

<div style="margin-top:8px">
<div class="tooltip">區位說明 ℹ️
<span>
表二 區位因素調整表<br>
優質區位 5%：交通便利、生活機能完善、就業就學密集<br>
中上區位 3%：主要生活圈、交通可及性佳<br>
中下區位 0%：交通與生活機能相對不足
</span>
</div><br>

<div class="tooltip">裝修說明 ℹ️
<span>
表三 室內裝修調整表<br>
中等裝修 5%：系統櫃、完整天花設計<br>
簡易裝修 3%：基本油漆、收納<br>
未裝修 0%
</span>
</div><br>

<div class="tooltip">設備說明 ℹ️
<span>
表四 設備調整<br>
套房上限 1,000 元／月<br>
非套房上限 2,000 元／月
</span>
</div>
</div>

</fieldset>

<button type="submit">送出試算</button>
</form>

<div id="result" class="result"></div>
<div id="detail" class="detail"></div>
<div class="note">以上試算結果僅供參考，最後結果將由審查單位認定</div>

<script>
// ===== 單價表（已依官方表逐列核對） =====
const STUDIO_TABLE = {
"西屯區":[1120,1100,1080,1055,1025,1000,970,930,885],
"北屯區":[1060,1040,1025,995,970,945,920,880,840],
"南屯區":[1060,1040,1025,995,970,945,920,880,840],
"北區":[1045,1030,1010,985,960,935,905,870,830],
"西區":[1045,1030,1010,985,960,935,905,870,830],
"中區":[1010,995,975,950,925,900,875,840,800],
"東區":[1010,995,975,950,925,900,875,840,800],
"南區":[985,970,955,930,905,880,855,820,780],
"烏日區":[940,925,905,885,860,835,815,780,745],
"大里區":[915,900,885,860,840,815,795,760,725],
"潭子區":[915,900,885,860,840,815,795,760,725],
"大雅區":[890,875,860,840,815,795,770,740,705],
"太平區":[890,875,860,840,815,795,770,740,705],
"沙鹿區":[890,875,860,840,815,795,770,740,705],
"后里區":[855,840,825,805,785,760,740,710,675],
"大肚區":[840,830,815,795,775,750,730,700,665],
"神岡區":[840,830,815,795,775,750,730,700,665],
"豐原區":[840,830,815,795,775,750,730,700,665],
"梧棲區":[830,815,805,780,760,740,720,690,660],
"龍井區":[830,815,805,780,760,740,720,690,660],
"大甲區":[780,770,755,735,720,700,680,650,620],
"外埔區":[720,710,700,680,660,645,625,600,570],
"石岡區":[720,710,700,680,660,645,625,600,570],
"霧峰區":[720,710,700,680,660,645,625,600,570],
"清水區":[590,580,570,555,540,525,510,490,470],
"新社區":[480,475,465,455,445,430,420,400,380],
"東勢區":[480,475,465,455,445,430,420,400,380],
"其它":[385,380,375,365,355,345,335,320,305]
};

const HOUSE_TABLE = {
"西屯區":[940,925,905,885,860,835,815,780,745],
"北屯區":[900,885,870,850,830,805,780,750,715],
"南屯區":[900,885,870,850,830,805,780,750,715],
"北區":[890,875,860,840,815,795,770,740,705],
"西區":[890,875,860,840,815,795,770,740,705],
"中區":[830,815,805,780,760,740,720,690,660],
"東區":[830,815,805,780,760,740,720,690,660],
"烏日區":[830,815,805,780,760,740,720,690,660],
"南區":[780,770,755,735,720,700,680,650,620],
"大里區":[770,760,745,725,705,685,670,640,610],
"太平區":[770,760,745,725,705,685,670,640,610],
"潭子區":[770,760,745,725,705,685,670,640,610],
"豐原區":[770,760,745,725,705,685,670,640,610],
"后里區":[675,665,650,635,620,600,585,560,535],
"沙鹿區":[675,665,650,635,620,600,585,560,535],
"龍井區":[675,665,650,635,620,600,585,560,535],
"大肚區":[660,650,640,625,605,590,575,550,525],
"大雅區":[660,650,640,625,605,590,575,550,525],
"神岡區":[660,650,640,625,605,590,575,550,525],
"梧棲區":[600,590,580,565,550,535,520,500,475],
"清水區":[580,570,560,545,530,515,500,480,460],
"大甲區":[565,555,550,535,520,505,490,470,450],
"外埔區":[505,500,490,475,465,450,440,420,400],
"霧峰區":[505,500,490,475,465,450,440,420,400],
"石岡區":[495,485,480,465,455,440,430,410,390],
"東勢區":[460,450,445,430,420,410,400,380,365],
"新社區":[445,440,430,420,410,400,385,370,355],
"其它":[375,370,360,355,345,335,325,310,295]
};

const AGE_BANDS=[4,9,14,19,24,29,34,39,999];
const band=i=>AGE_BANDS.findIndex(v=>i<=v);

document.getElementById("form").onsubmit=e=>{
e.preventDefault();

const d=district.value;
const a=+age.value;
const p=+ping.value;
const r=+rent.value;

const isStudio=p<=15;
const table=isStudio?STUDIO_TABLE:HOUSE_TABLE;
const limit=isStudio?21000:35000;

const res=document.getElementById("result");
const det=document.getElementById("detail");

if(r>limit){
res.textContent="無法承作";
res.className="result warn";
det.textContent=`${isStudio?"套房":"非套房"}租金上限 ${limit.toLocaleString()} 元`;
return;
}

const row=table[d];
const idx=band(a);
const base=row[0];
const unit=row[idx];
const rate=((unit/base-1)*100).toFixed(2);
const max=Math.ceil(unit*p);

if(max>=r){
res.textContent="O";
res.className="result ok";
det.innerHTML=`行政區：<b>${d}</b><br>租金區間表（0–4 年基準）：<b>${base}</b><br>調等率：<b>${rate}%</b>`;
}else{
res.textContent="X";
res.className="result warn";

const deco=+deco.value;
const area=+area.value;
const equipCap=isStudio?1000:2000;
const equip=Math.min(+equip.value,equipCap);

const bonus=Math.ceil(max*(deco+area)/100)+equip;
const max2=max+bonus;

det.innerHTML=
`行政區：<b>${d}</b><br>
最高租金：<b>${max.toLocaleString()}</b><br>
<div class="bonus-box">
額外加分後最高租金：<b>${max2.toLocaleString()}</b><br>
加分後判斷：<b style="color:${max2>=r?"green":"red"}">${max2>=r?"O":"X"}</b>
</div>`;
}
};

// tooltip for mobile
document.querySelectorAll(".tooltip").forEach(t=>{
t.onclick=e=>{e.stopPropagation();t.classList.toggle("show");}
});
document.body.onclick=()=>document.querySelectorAll(".tooltip").forEach(t=>t.classList.remove("show"));
</script>

</body>
</html>
